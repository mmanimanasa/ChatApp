(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{173:function(e){e.exports={v:"5.5.2",fr:60,ip:0,op:104,w:84,h:40,nm:"Typing-Indicator",ddd:0,assets:[],layers:[{ddd:0,ind:1,ty:4,nm:"Oval 3",sr:1,ks:{o:{a:1,k:[{i:{x:[.643],y:[1]},o:{x:[1],y:[0]},t:18,s:[35],e:[100]},{i:{x:[.099],y:[1]},o:{x:[.129],y:[0]},t:33,s:[100],e:[35]},{i:{x:[.833],y:[1]},o:{x:[.167],y:[0]},t:65,s:[35],e:[35]},{t:71}],ix:11,x:"var $bm_rt;\n$bm_rt = loopOut('cycle', 0);"},r:{a:0,k:0,ix:10},p:{a:0,k:[61,20,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:1,k:[{i:{x:[.667,.667,.667],y:[1,1,1]},o:{x:[1,1,.333],y:[0,0,0]},t:18,s:[100,100,100],e:[140,140,100]},{i:{x:[.032,.032,.667],y:[1,1,1]},o:{x:[.217,.217,.333],y:[0,0,0]},t:33,s:[140,140,100],e:[100,100,100]},{i:{x:[.833,.833,.833],y:[1,1,1]},o:{x:[.167,.167,.167],y:[0,0,0]},t:65,s:[100,100,100],e:[100,100,100]},{t:71}],ix:6,x:"var $bm_rt;\n$bm_rt = loopOut('cycle', 0);"}},ao:0,shapes:[{ty:"gr",it:[{d:1,ty:"el",s:{a:0,k:[12,12],ix:2},p:{a:0,k:[0,0],ix:3},nm:"Ellipse Path 1",mn:"ADBE Vector Shape - Ellipse",hd:!1},{ty:"fl",c:{a:0,k:[.847000002861,.847000002861,.847000002861,1],ix:4},o:{a:0,k:100,ix:5},r:1,bm:0,nm:"Fill 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Oval 3",np:2,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:3600,st:0,bm:0},{ddd:0,ind:2,ty:4,nm:"Oval 2",sr:1,ks:{o:{a:1,k:[{i:{x:[.667],y:[1]},o:{x:[1],y:[0]},t:9,s:[35],e:[98]},{i:{x:[.023],y:[1]},o:{x:[.179],y:[0]},t:24,s:[98],e:[35]},{i:{x:[.833],y:[1]},o:{x:[.167],y:[0]},t:56,s:[35],e:[35]},{t:62}],ix:11,x:"var $bm_rt;\n$bm_rt = loopOut('cycle', 0);"},r:{a:0,k:0,ix:10},p:{a:0,k:[41,20,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:1,k:[{i:{x:[.654,.654,.667],y:[1,1,1]},o:{x:[1,1,.333],y:[0,0,0]},t:9,s:[100,100,100],e:[140,140,100]},{i:{x:[.11,.11,.667],y:[1,1,1]},o:{x:[.205,.205,.333],y:[0,0,0]},t:24,s:[140,140,100],e:[100,100,100]},{i:{x:[.833,.833,.833],y:[1,1,1]},o:{x:[.167,.167,.167],y:[0,0,0]},t:56,s:[100,100,100],e:[100,100,100]},{t:62}],ix:6,x:"var $bm_rt;\n$bm_rt = loopOut('cycle', 0);"}},ao:0,shapes:[{ty:"gr",it:[{d:1,ty:"el",s:{a:0,k:[12,12],ix:2},p:{a:0,k:[0,0],ix:3},nm:"Ellipse Path 1",mn:"ADBE Vector Shape - Ellipse",hd:!1},{ty:"fl",c:{a:0,k:[.847000002861,.847000002861,.847000002861,1],ix:4},o:{a:0,k:100,ix:5},r:1,bm:0,nm:"Fill 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Oval 2",np:2,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:3600,st:0,bm:0},{ddd:0,ind:3,ty:4,nm:"Oval 1",sr:1,ks:{o:{a:1,k:[{i:{x:[.667],y:[1]},o:{x:[1],y:[0]},t:0,s:[35],e:[100]},{i:{x:[.067],y:[1]},o:{x:[.125],y:[0]},t:15,s:[100],e:[35]},{i:{x:[.833],y:[1]},o:{x:[.167],y:[0]},t:47,s:[35],e:[35]},{t:53}],ix:11,x:"var $bm_rt;\n$bm_rt = loopOut('cycle', 0);"},r:{a:0,k:0,ix:10},p:{a:0,k:[21,20,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:1,k:[{i:{x:[.673,.673,.667],y:[1,1,1]},o:{x:[1,1,.333],y:[0,0,0]},t:0,s:[100,100,100],e:[140,140,100]},{i:{x:[.049,.049,.667],y:[1,1,1]},o:{x:[.198,.198,.333],y:[0,0,0]},t:15,s:[140,140,100],e:[100,100,100]},{i:{x:[.833,.833,.833],y:[1,1,1]},o:{x:[.167,.167,.167],y:[0,0,0]},t:47,s:[100,100,100],e:[100,100,100]},{t:53}],ix:6,x:"var $bm_rt;\n$bm_rt = loopOut('cycle', 0);"}},ao:0,shapes:[{ty:"gr",it:[{d:1,ty:"el",s:{a:0,k:[12,12],ix:2},p:{a:0,k:[0,0],ix:3},nm:"Ellipse Path 1",mn:"ADBE Vector Shape - Ellipse",hd:!1},{ty:"fl",c:{a:0,k:[.847000002861,.847000002861,.847000002861,1],ix:4},o:{a:0,k:100,ix:5},r:1,bm:0,nm:"Fill 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Oval 1",np:2,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:3600,st:0,bm:0},{ddd:0,ind:4,ty:4,nm:"BG",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[42,20,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-42,-20],[42,-20],[42,20],[-42,20]],c:!0},ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"rd",nm:"Round Corners 1",r:{a:0,k:20,ix:1},ix:2,mn:"ADBE Vector Filter - RC",hd:!1},{ty:"fl",c:{a:0,k:[.96078401804,.96078401804,.96078401804,1],ix:4},o:{a:0,k:100,ix:5},r:1,bm:0,nm:"Fill 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"BG",np:3,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:3600,st:0,bm:0}],markers:[]}},215:function(e,t,a){e.exports=a(283)},220:function(e,t,a){},221:function(e,t,a){},233:function(e,t,a){},283:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(49),i=a.n(l),s=(a(220),a(221),a(299)),o=a(300),c=a(301),m=a(325),d=a(9),u=a(323),p=a(84),h=a(295),E=a(324),x=a(296),g=a(297),b=a(177),f=a(17),y=a(317);var C=()=>{const[e,t]=Object(n.useState)(),[a,l]=Object(n.useState)(),[i,s]=Object(n.useState)(!1),[o,c]=Object(n.useState)(),[m,C]=Object(n.useState)(!1),k=Object(d.useToast)(),O=Object(f.e)();return r.a.createElement(u.b,{spacing:"10px"},r.a.createElement(p.a,{id:"email",isRequired:!0},r.a.createElement(h.a,null,"Email Address"),r.a.createElement(E.a,{value:a,type:"email",placeholder:"Enter Your Email Address",onChange:e=>l(e.target.value)})),r.a.createElement(p.a,{id:"password",isRequired:!0},r.a.createElement(h.a,null,"Password"),r.a.createElement(x.a,{size:"md"},r.a.createElement(E.a,{value:o,onChange:e=>c(e.target.value),type:i?"text":"password",placeholder:"Enter password"}),r.a.createElement(g.a,{width:"4.5rem"},r.a.createElement(b.a,{h:"1.75rem",size:"sm",onClick:()=>s(!i)},i?"Hide":"Show")))),r.a.createElement(b.a,{colorScheme:"green",width:"100%",style:{marginTop:15},onClick:async()=>{if(C(!0),!a||!o)return k({title:"Please Fill all the Feilds",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void C(!1);try{const t={headers:{"Content-type":"application/json"}},{data:n}=await y.a.post("/api/user/login",{email:a,password:o},t);k({title:"Login Successful",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),localStorage.setItem("userInfo",JSON.stringify(n)),C(!1),O.push("/chats")}catch(e){k({title:"Error Occured!",description:e.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),C(!1)}},isLoading:m},"Login"),r.a.createElement(b.a,{variant:"solid",colorScheme:"blue",width:"100%",onClick:()=>{l("guest@example.com"),c("123456")}},"Get Guest User Credentials"))};var k=()=>{const[e,t]=Object(n.useState)(),[a,l]=Object(n.useState)(),[i,s]=Object(n.useState)(!1),[o,c]=Object(n.useState)(),[m,C]=Object(n.useState)(),k=()=>s(!i),O=Object(d.useToast)(),S=Object(f.e)();return r.a.createElement(u.b,{spacing:"5px"},r.a.createElement(p.a,{id:"first-name",isRequired:!0},r.a.createElement(h.a,null,"Name"),r.a.createElement(E.a,{placeholder:"Enter Your Name",onChange:e=>t(e.target.value)})),r.a.createElement(p.a,{id:"email",isRequired:!0},r.a.createElement(h.a,null,"Email Address"),r.a.createElement(E.a,{type:"email",placeholder:"Enter Your Email Address",onChange:e=>l(e.target.value)})),r.a.createElement(p.a,{id:"password",isRequired:!0},r.a.createElement(h.a,null,"Password"),r.a.createElement(x.a,{size:"md"},r.a.createElement(E.a,{type:i?"text":"password",placeholder:"Enter Password",onChange:e=>c(e.target.value)}),r.a.createElement(g.a,{width:"4.5rem"},r.a.createElement(b.a,{h:"1.75rem",size:"sm",onClick:k},i?"Hide":"Show")))),r.a.createElement(p.a,{id:"password",isRequired:!0},r.a.createElement(h.a,null,"Confirm Password"),r.a.createElement(x.a,{size:"md"},r.a.createElement(E.a,{type:i?"text":"password",placeholder:"Confirm password",onChange:e=>C(e.target.value)}),r.a.createElement(g.a,{width:"4.5rem"},r.a.createElement(b.a,{h:"1.75rem",size:"sm",onClick:k},i?"Hide":"Show")))),r.a.createElement(b.a,{colorScheme:"green",width:"100%",style:{marginTop:15},onClick:async()=>{if(e&&a&&o&&m)if(o===m)try{const n={headers:{"Content-type":"application/json"}},{data:r}=await y.a.post("/api/user",{name:e,email:a,password:o},n);console.log(r),O({title:" Successful Registration",status:"success",duration:5e3,isClosable:!0,position:"bottom"}),localStorage.setItem("userInfo",JSON.stringify(r)),S.push("/chats")}catch(t){O({title:"Error Occured!",description:t.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"})}else O({title:"Passwords Do Not Match",status:"warning",duration:5e3,isClosable:!0,position:"bottom"});else O({title:"Please Fill all the Feilds",status:"warning",duration:5e3,isClosable:!0,position:"bottom"})}},"Sign Up"))};var O=()=>{const e=Object(f.e)();return Object(n.useEffect)(()=>{JSON.parse(localStorage.getItem("userInfo"))||e.push("/")},[e]),r.a.createElement(s.a,{maxW:"xl",centerContent:!0},r.a.createElement(o.a,{d:"flex",justifyContent:"center",p:3,bg:"white",w:"100%",m:"40px 0 15px 0",borderRadius:"lg",borderWidth:"1px"},r.a.createElement(c.a,{fontSize:"4xl",m:"0 150px",fontFamily:"Work sans",color:"black"},"Chit-Chat")),r.a.createElement(o.a,{bg:"white",w:"100%",p:4,borderRadius:"lg",borderWidth:"1px"},r.a.createElement(m.e,{isFitted:!0,variant:"soft-rounded"},r.a.createElement(m.b,{mb:"1em"},r.a.createElement(m.a,null,"Login"),r.a.createElement(m.a,null,"Sign Up")),r.a.createElement(m.d,null,r.a.createElement(m.c,null,r.a.createElement(C,null)),r.a.createElement(m.c,null,r.a.createElement(k,null))))))};const S=Object(n.createContext)(),v=()=>Object(n.useContext)(S);var w=e=>{let{children:t}=e;const[a,l]=Object(n.useState)(),[i,s]=Object(n.useState)(),[o,c]=Object(n.useState)([]),[m,d]=Object(n.useState)([]),u=Object(f.e)();return Object(n.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("userInfo"));l(e),e||u.push("/")},[u]),r.a.createElement(S.Provider,{value:{user:a,setuser:l,selectedChat:i,setSelectedChat:s,chats:o,setChats:c,notification:m,setNotification:d}},t)},j=a(308);const _=(e,t,a,n)=>a<e.length-1&&e[a+1].sender._id===t.sender._id&&e[a].sender._id!==n?33:a<e.length-1&&e[a+1].sender._id!==t.sender._id&&e[a].sender._id!==n||a===e.length-1&&e[a].sender._id!==n?0:"auto",F=(e,t,a)=>a>0&&e[a-1].sender._id===t.sender._id,A=(e,t)=>{var a;return(null===(a=t[0])||void 0===a?void 0:a._id)===(null===e||void 0===e?void 0:e._id)?t[1].name:t[0].name},z=(e,t)=>t[0]._id===e._id?t[1]:t[0];var B=a(318);var I=()=>r.a.createElement(u.a,null,r.a.createElement(B.a,{height:"45px"}),r.a.createElement(B.a,{height:"45px"}),r.a.createElement(B.a,{height:"45px"}),r.a.createElement(B.a,{height:"45px"}),r.a.createElement(B.a,{height:"45px"}),r.a.createElement(B.a,{height:"45px"}),r.a.createElement(B.a,{height:"45px"}),r.a.createElement(B.a,{height:"45px"}),r.a.createElement(B.a,{height:"45px"}),r.a.createElement(B.a,{height:"45px"}),r.a.createElement(B.a,{height:"45px"}),r.a.createElement(B.a,{height:"45px"})),$=a(307),N=a(41),D=a(305),R=a(304);var G=e=>{let{user:t,handleFunction:a,admin:n}=e;return r.a.createElement(R.a,{px:2,py:1,borderRadius:"lg",m:1,mb:2,variant:"solid",fontSize:12,colorScheme:"purple",cursor:"pointer",onClick:a},t.name,n===t._id&&r.a.createElement("span",null," (Admin)"),r.a.createElement(D.a,{pl:1}))},T=a(306);var W=e=>{let{user:t,handleFunction:a}=e;return r.a.createElement(o.a,{onClick:a,cursor:"pointer",bg:"#E8E8E8",_hover:{background:"#38B2AC",color:"white"},w:"100%",display:"flex",alignItems:"center",color:"black",px:3,py:2,mb:2,borderRadius:"lg"},r.a.createElement(T.a,{mr:2,size:"sm",cursor:"pointer",name:t.name,src:t.pic}),r.a.createElement(o.a,null,r.a.createElement(c.a,null,t.name),r.a.createElement(c.a,{fontSize:"xs"},r.a.createElement("b",null,"Email : "),t.email)))};var L=e=>{let{children:t}=e;const{isOpen:a,onOpen:l,onClose:i}=Object($.a)(),[s,c]=Object(n.useState)(),[m,u]=Object(n.useState)([]),[h,x]=Object(n.useState)(""),[g,f]=Object(n.useState)([]),[C,k]=Object(n.useState)(!1),O=Object(d.useToast)(),{user:S,chats:w,setChats:j}=v();return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{onClick:l},t),r.a.createElement(N.a,{onClose:i,isOpen:a,isCentered:!0},r.a.createElement(N.h,null),r.a.createElement(N.d,null,r.a.createElement(N.g,{fontSize:"35px",fontFamily:"Work sans",display:"flex",justifyContent:"center"},"Create Group Chat"),r.a.createElement(N.c,null),r.a.createElement(N.b,{display:"flex",flexDir:"column",alignItems:"center"},r.a.createElement(p.a,null,r.a.createElement(E.a,{placeholder:"Chat Name",mb:3,onChange:e=>c(e.target.value)})),r.a.createElement(p.a,null,r.a.createElement(E.a,{placeholder:"Add Users eg: John",mb:1,onChange:e=>(async e=>{if(x(e),e)try{k(!0);const e={headers:{Authorization:`Bearer ${S.token}`}},{data:a}=await y.a.get(`/api/user?search=${h}`,e);k(!1),f(a)}catch(t){O({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}})(e.target.value)})),r.a.createElement(o.a,{w:"100%",display:"flex",flexWrap:"wrap"},m.map(e=>r.a.createElement(G,{key:e._id,user:e,handleFunction:()=>(e=>{u(m.filter(t=>t._id!==e._id))})(e)}))),C?r.a.createElement("div",null,"Loading..."):null===g||void 0===g?void 0:g.slice(0,4).map(e=>r.a.createElement(W,{key:e._id,user:e,handleFunction:()=>(e=>{m.includes(e)?O({title:"User already added",status:"warning",duration:5e3,isClosable:!0,position:"top"}):u([...m,e])})(e)}))),r.a.createElement(N.f,null,r.a.createElement(b.a,{onClick:async()=>{if(s&&m)try{const t={headers:{Authorization:`Bearer ${S.token}`}},{data:a}=await y.a.post("/api/chat/group",{name:s,users:JSON.stringify(m.map(e=>e._id))},t);j([a,...w]),i(),O({title:"New Group Chat Created!",status:"success",duration:5e3,isClosable:!0,position:"bottom"})}catch(e){O({title:"Failed to Create the Chat!",description:e.response.data,status:"error",duration:5e3,isClosable:!0,position:"bottom"})}else O({title:"Please fill all the feilds",status:"warning",duration:5e3,isClosable:!0,position:"top"})},colorScheme:"blue"},"Create Chat")))))};var P=e=>{let{fetchAgain:t}=e;const[a,l]=Object(n.useState)(),{selectedChat:i,setSelectedChat:s,user:m,chats:p,setChats:h}=v(),E=Object(d.useToast)();return Object(n.useEffect)(()=>{l(JSON.parse(localStorage.getItem("userInfo"))),(async()=>{try{const t={headers:{Authorization:`Bearer ${m.token}`}},{data:a}=await y.a.get("/api/chat",t);h(a)}catch(e){E({title:"Error Occured!",description:"Failed to Load the chats",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}})()},[t]),r.a.createElement(o.a,{display:{base:i?"none":"flex",md:"flex"},flexDir:"column",alignItems:"center",p:3,bg:"white",w:{base:"100%",md:"31%"},borderRadius:"lg",borderWidth:"1px"},r.a.createElement(o.a,{pb:3,px:3,fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",display:"flex",w:"100%",justifyContent:"space-between",alignItems:"center"},"My Chats",r.a.createElement(L,null,r.a.createElement(b.a,{d:"flex",fontSize:{base:"17px",md:"10px",lg:"17px"},rightIcon:r.a.createElement(j.a,null)},"New Group Chat"))),r.a.createElement(o.a,{display:"flex",flexDir:"column",p:3,bg:"#F8F8F8",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden"},p?r.a.createElement(u.a,{overflowY:"scroll"},p.map(e=>r.a.createElement(o.a,{onClick:()=>s(e),cursor:"pointer",bg:i===e?"#38B2AC":"#E8E8E8",color:i===e?"white":"black",px:3,py:2,borderRadius:"lg",key:e._id},r.a.createElement(c.a,null,e.isGroupChat?e.chatName:A(a,e.users)),e.latestMessage&&r.a.createElement(c.a,{fontSize:"xs"},r.a.createElement("b",null,e.latestMessage.sender.name," : "),e.latestMessage.content.length>50?e.latestMessage.content.substring(0,51)+"...":e.latestMessage.content)))):r.a.createElement(I,null)))},M=a(309),U=a(298),V=a(312),J=a(310),q=a(311);var Y=e=>{let{user:t,children:a}=e;const{isOpen:n,onOpen:l,onClose:i}=Object($.a)();return r.a.createElement(r.a.Fragment,null,a?r.a.createElement("span",{onClick:l},a):r.a.createElement(M.a,{display:{base:"flex"},icon:r.a.createElement(J.a,null),onClick:l}),r.a.createElement(N.a,{size:"md",onClose:i,isOpen:n,isCentered:!0},r.a.createElement(N.h,null),r.a.createElement(N.d,{h:"410px"},r.a.createElement(N.g,{fontSize:"40px",fontFamily:"Work sans",display:"flex",justifyContent:"center"},t.name),r.a.createElement(N.c,null),r.a.createElement(N.b,{display:"flex",flexDir:"column",alignItems:"center",justifyContent:"space-between"},r.a.createElement(q.a,{borderRadius:"full",boxSize:"150px",src:t.pic,alt:t.name}),r.a.createElement(c.a,{fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans"},"Email: ",t.email)),r.a.createElement(N.f,null,r.a.createElement(b.a,{onClick:i},"Close")))))};var H=e=>{let{fetchMessages:t,fetchAgain:a,setFetchAgain:l}=e;const{isOpen:i,onOpen:s,onClose:c}=Object($.a)(),[m,u]=Object(n.useState)(),[h,x]=Object(n.useState)(""),[g,f]=Object(n.useState)([]),[C,k]=Object(n.useState)(!1),[O,S]=Object(n.useState)(!1),w=Object(d.useToast)(),{selectedChat:j,setSelectedChat:_,user:F}=v(),A=async e=>{if(j.users.find(t=>t._id===e._id))w({title:"User Already in group!",status:"error",duration:5e3,isClosable:!0,position:"bottom"});else if(j.groupAdmin._id===F._id){try{k(!0);const n={headers:{Authorization:`Bearer ${F.token}`}},{data:r}=await y.a.put("/api/chat/groupadd",{chatId:j._id,userId:e._id},n);_(r),l(!a),k(!1)}catch(t){w({title:"Error Occured!",description:"Failed to Add the User",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),k(!1)}u("")}else w({title:"Only admins can add someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"})},z=async e=>{if(j.groupAdmin._id===F._id||e._id===F._id){try{k(!0);const r={headers:{Authorization:`Bearer ${F.token}`}},{data:i}=await y.a.put("/api/chat/groupremove",{chatId:j._id,userId:e._id},r);e._id===F._id?_():_(i),l(!a),t(),k(!1)}catch(n){w({title:"Error Occured!",description:"Failed to Remove the User",status:"error",duration:5e3,isClosable:!0,position:"bottom"}),k(!1)}u("")}else w({title:"Only admins can remove someone!",status:"error",duration:5e3,isClosable:!0,position:"bottom"})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(M.a,{display:{base:"flex"},icon:r.a.createElement(J.a,null),onClick:s}),r.a.createElement(N.a,{onClose:c,isOpen:i,isCentered:!0},r.a.createElement(N.h,null),r.a.createElement(N.d,null,r.a.createElement(N.g,{fontSize:"35px",fontFamily:"Work sans",display:"flex",justifyContent:"center"},j.chatName),r.a.createElement(N.c,null),r.a.createElement(N.b,{display:"flex",flexDir:"column",alignItems:"center"},r.a.createElement(o.a,{w:"100%",display:"flex",flexWrap:"wrap",pb:3},j.users.map(e=>r.a.createElement(G,{key:e._id,user:e,admin:j.groupAdmin,handleFunction:()=>z(e)}))),r.a.createElement(p.a,{display:"flex"},r.a.createElement(E.a,{placeholder:"Chat Name",mb:3,value:m,onChange:e=>u(e.target.value)}),r.a.createElement(b.a,{variant:"solid",colorScheme:"teal",ml:1,isLoading:O,onClick:async()=>{if(m){try{S(!0);const t={headers:{Authorization:`Bearer ${F.token}`}},{data:n}=await y.a.put("/api/chat/rename",{chatId:j._id,chatName:m},t);console.log(n._id),_(n),S(!1),l(!a)}catch(e){S(!1)}u("")}}},"Update")),r.a.createElement(p.a,null,r.a.createElement(E.a,{placeholder:"Add User to group",mb:1,onChange:e=>(async e=>{if(x(e),e)try{k(!0);const e={headers:{Authorization:`Bearer ${F.token}`}},{data:a}=await y.a.get(`/api/user?search=${h}`,e);console.log(a),k(!1),f(a)}catch(t){w({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"}),k(!1)}})(e.target.value)})),C?r.a.createElement(U.a,{size:"lg"}):null===g||void 0===g?void 0:g.map(e=>r.a.createElement(W,{key:e._id,user:e,handleFunction:()=>A(e)}))),r.a.createElement(N.f,null,r.a.createElement(b.a,{onClick:()=>z(F),colorScheme:"red"},"Leave Group")))))},K=a(320),Q=a(171);var X=e=>{let{messages:t}=e;const{user:a}=v();return r.a.createElement(Q.a,null,t&&t.map((e,n)=>r.a.createElement("div",{style:{display:"flex"},key:e._id},(((e,t,a,n)=>a<e.length-1&&(e[a+1].sender._id!==t.sender._id||void 0===e[a+1].sender._id)&&e[a].sender._id!==n)(t,e,n,a._id)||((e,t,a)=>t===e.length-1&&e[e.length-1].sender._id!==a&&e[e.length-1].sender._id)(t,n,a._id))&&r.a.createElement(K.a,{label:e.sender.name,placement:"bottom-start",hasArrow:!0},r.a.createElement(T.a,{mt:"7px",mr:1,size:"sm",cursor:"pointer",name:e.sender.name,src:e.sender.pic})),r.a.createElement("span",{style:{backgroundColor:`${e.sender._id===a._id?"#BEE3F8":"#B9F5D0"}`,marginLeft:_(t,e,n,a._id),marginTop:F(t,e,n,a._id)?3:10,borderRadius:"20px",padding:"5px 15px",maxWidth:"75%"}},e.content))))},Z=a(175),ee=(a(233),a(172)),te=a.n(ee),ae=a(173);var ne,re;var le=e=>{let{fetchAgain:t,setFetchAgain:a}=e;console.log(t,"start");const{user:l,selectedChat:i,setSelectedChat:s,notification:m,setNotification:u}=v(),[h,x]=Object(n.useState)([]),[g,b]=Object(n.useState)(!1),[f,C]=Object(n.useState)(),[k,O]=Object(n.useState)(!1),[S,w]=Object(n.useState)(!1),[j,_]=Object(n.useState)(!1),F=Object(d.useToast)(),B={loop:!0,autoplay:!0,animationData:ae,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},I=async()=>{if(i)try{const t={headers:{Authorization:`Bearer ${l.token}`}};b(!0);const{data:a}=await y.a.get(`/api/message/${i._id}`,t);x(a),b(!1),ne.emit("join chat",i._id)}catch(e){F({title:"Error Occured!",description:"Failed to Load the Messages",status:"error",duration:5e3,isClosable:!0,position:"bottom"})}};return Object(n.useEffect)(()=>{(ne=Object(Z.a)("http://localhost:5000")).emit("setup",l),ne.on("connected",()=>O(!0)),ne.on("typing",()=>_(!0)),ne.on("stop typing",()=>_(!1))},[]),Object(n.useEffect)(()=>{I(),re=i},[i]),console.log("--",m),Object(n.useEffect)(()=>{ne.on("message recieved",e=>{re&&re._id===e.chat._id?x([...h,e]):m.includes(e)||(u([e,...m]),console.log(t),a(!t))})}),r.a.createElement(r.a.Fragment,null,i?r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{fontSize:{base:"28px",md:"30px"},pb:3,px:2,w:"100%",fontFamily:"Work sans",d:"flex",justifyContent:{base:"space-between"},alignItems:"center"},r.a.createElement(M.a,{display:{base:"flex",md:"none"},icon:r.a.createElement(V.a,null),onClick:()=>s("")}),i.isGroupChat?r.a.createElement(r.a.Fragment,null,i.chatName.toUpperCase(),r.a.createElement(H,{fetchAgain:t,setFetchAgain:a,fetchMessages:I})):r.a.createElement(r.a.Fragment,null,A(l,i.users),r.a.createElement(Y,{user:z(l,i.users)}))),r.a.createElement(o.a,{display:"flex",flexDir:"column",justifyContent:"flex-end",p:3,bg:"#E8E8E8",w:"100%",h:"100%",borderRadius:"lg",overflow:"hidden"},g?r.a.createElement(U.a,{size:"xl",w:20,h:20,alignSelf:"center",margin:"auto"}):r.a.createElement("div",{className:"messages"},r.a.createElement(X,{messages:h})),r.a.createElement(p.a,{onKeyDown:async e=>{if("Enter"===e.key&&f){ne.emit("stop typing",i._id);try{const e={headers:{"Content-type":"application/json",Authorization:`Bearer ${l.token}`}};C("");const{data:a}=await y.a.post("/api/message",{content:f,chatId:i},e);ne.emit("new message",a),x([...h,a])}catch(t){F({title:"Error Occured!",description:"Failed to send the Message",status:"error",duration:5e3,isClosable:!0,position:"bottom"})}}},isRequired:!0,marginTop:3},j?r.a.createElement("div",null,r.a.createElement(te.a,{options:B,width:70,style:{marginBottom:15,marginLeft:0}})):r.a.createElement("div",null),r.a.createElement(E.a,{variant:"filled",bg:"#E0E0E0",placeholder:"Enter a message..",value:f,onChange:e=>{if(C(e.target.value),!k)return;S||(w(!0),ne.emit("typing",i._id));let t=(new Date).getTime();setTimeout(()=>{(new Date).getTime()-t>=3e3&&S&&(ne.emit("stop typing",i._id),w(!1))},3e3)}})))):r.a.createElement(o.a,{d:"flex",alignItems:"center",justifyContent:"center",h:"100%"},r.a.createElement(c.a,{fontSize:"3xl",pb:3,fontFamily:"Work sans"},"Click on a user to start chatting")))};var ie=e=>{let{fetchAgain:t,setFetchAgain:a}=e;const{selectedChat:n}=v();return console.log(t),r.a.createElement(o.a,{display:{base:n?"flex":"none",md:"flex"},alignItems:"center",flexDir:"column",padding:3,bg:"white",w:{base:"100%",md:"68%"},borderRadius:"lg",borderWidth:"1px"},r.a.createElement(le,{fetchAgain:t,setFetchAgain:a}))},se=a(319),oe=a(327),ce=a(313),me=a(314);var de=()=>{const[e,t]=Object(n.useState)(""),[a,l]=Object(n.useState)([]),[i,s]=Object(n.useState)(!1),[m,u]=Object(n.useState)(),p=Object(f.e)(),{isOpen:h,onOpen:x,onClose:g}=Object($.a)(),C=Object(d.useToast)(),{user:k,selectedChat:O,setSelectedChat:S,chats:w,setChats:j,notification:_,setNotification:F}=v(),z=async e=>{try{u(!0);const a={headers:{"Content-type":"application/json",Authorization:`Bearer ${k.token}`}},{data:n}=await y.a.post("/api/chat",{userId:e},a);w.find(e=>e._id===n._id)||j([n,...w]),S(n),u(!1),g()}catch(t){C({title:"Error fetching the chat",description:t.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(o.a,{display:"flex",justifyContent:"space-between",alignItems:"center",bg:"white",w:"100%",p:"5px 10px 5px 10px",borderWidth:"5px"},r.a.createElement(K.a,{label:"Search User"},r.a.createElement(b.a,{variant:"ghost",onClick:x},r.a.createElement("i",{className:"fas fa-search"}),r.a.createElement(c.a,{d:{base:"none",md:"flex"},px:4},"Search User"))),r.a.createElement(c.a,{fontSize:"2xl",fontWeight:"bold",fontStyle:"italic",fontFamily:"Work sans"},"Chit-Chat"),r.a.createElement("div",null,r.a.createElement(se.a,null,r.a.createElement(se.b,{p:1},r.a.createElement(ce.a,{fontSize:"2xl",m:1,color:_.length?"red.400":"blue.400"})),r.a.createElement(se.d,{pl:2},!_.length&&"No New Messages",_.map(e=>r.a.createElement(se.c,{key:e._id,onClick:()=>{S(e.chat),F(_.filter(t=>t!==e))}},e.chat.isGroupChat?`New Message in ${e.chat.chatName}`:`New Message from ${A(k,e.chat.users)}`)))),r.a.createElement(se.a,null,r.a.createElement(se.b,{as:b.a,rightIcon:r.a.createElement(me.a,null)},r.a.createElement(T.a,{size:"sm",cursor:"pointer",name:k.name})),r.a.createElement(se.d,null,r.a.createElement(Y,{user:k},r.a.createElement(se.c,null,"Profile")),r.a.createElement(se.c,{onClick:()=>{localStorage.removeItem("userInfo"),p.push("/")}},"Logout"))))),r.a.createElement(oe.a,{placement:"left",onClose:g,isOpen:h},r.a.createElement(N.h,null),r.a.createElement(oe.b,null,r.a.createElement(N.g,{borderBottomWidth:"1px"},"Search Users"),r.a.createElement(N.b,null,r.a.createElement(o.a,{display:"flex",paddingBottom:2},r.a.createElement(E.a,{placeholder:"Search by name or email",margin:2,value:e,onChange:e=>t(e.target.value)}),r.a.createElement(b.a,{onClick:async()=>{if(e)try{s(!0);const a={headers:{Authorization:`Bearer ${k.token}`}},{data:n}=await y.a.get(`/api/user?search=${e}`,a);s(!1),l(n)}catch(t){C({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"bottom-left"})}else C({title:"Please Enter something in search",status:"warning",duration:5e3,isClosable:!0,position:"top-left"})}},"Go")),i?r.a.createElement(I,null):null===a||void 0===a?void 0:a.map(e=>r.a.createElement(W,{key:e._id,user:e,handleFunction:()=>z(e._id)})),m&&r.a.createElement(U.a,{ml:"auto",d:"flex"})))))};var ue=()=>{const{user:e}=v(),[t,a]=Object(n.useState)(!1);return r.a.createElement("div",{style:{width:"100%"}},e&&r.a.createElement(de,null),r.a.createElement(o.a,{display:"flex",justifyContent:"space-between",w:"100%",h:"91.5vh",p:"10px"},e&&r.a.createElement(P,{fetchAgain:t}),e&&r.a.createElement(ie,{fetchAgain:t,setFetchAgain:a})))};var pe=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(f.a,{path:"/",component:O,exact:!0}),r.a.createElement(f.a,{path:"/chats",component:ue}))};var he=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,329)).then(t=>{let{getCLS:a,getFID:n,getFCP:r,getLCP:l,getTTFB:i}=t;a(e),n(e),r(e),l(e),i(e)})},Ee=a(160),xe=a(57);i.a.render(r.a.createElement(Ee.a,null,r.a.createElement(xe.a,null,r.a.createElement(w,null,r.a.createElement(pe,null)))),document.getElementById("root")),he()}},[[215,1,2]]]);
//# sourceMappingURL=main.b39b6118.chunk.js.map